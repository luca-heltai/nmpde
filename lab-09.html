
<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lab: Saddle point problems: Stokes Flow around a cylinder &#8212; Numerical Methods for Partial Differential Equations</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Indice" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Final projects" href="projects.html" />
    <link rel="prev" title="Lab: From CG Poisson to DG Poisson (SIPG)" href="lab-08.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="it">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Numerical Methods for Partial Differential Equations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="laboratories.html">
   Laboratories
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="lab-01.html">
     Introduction to deal.II: A Hands-On Laboratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-02.html">
     Lab 2: Exploring Basis Functions in deal.II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-03.html">
     Lab: Interpolating Functions and Computing Errors in deal.II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-04.html">
     Lab: Solving the Poisson Equation in deal.II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-05.html">
     Lab 5: Improving the Poisson Solver (ParsedConvergenceTable and AffineConstraints)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-06.html">
     Lab: Vector-Valued Finite Element Spaces in Linear Elasticity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-07.html">
     Lab: Error Estimation using MeshWorker::mesh_loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab-08.html">
     Lab: From CG Poisson to DG Poisson (SIPG)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lab: Saddle point problems: Stokes Flow around a cylinder
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="projects.html">
   Final projects
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/luca-heltai/nmpde"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/luca-heltai/nmpde/issues/new?title=Issue%20on%20page%20%2Flab-09.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/lab-09.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction-to-stokes-flow">
     Introduction to Stokes Flow
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#governing-equations">
       Governing Equations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weak-form-of-stokes-equations">
     Weak Form of Stokes Equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#weak-form">
       Weak Form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coupled-weak-form">
       Coupled Weak Form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boundary-conditions">
       Boundary Conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#salient-characteristics-of-stokes-flow">
       Salient Characteristics of Stokes Flow
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-stokes-flow-around-a-cylinder">
       Example: Stokes Flow Around a Cylinder
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#salient-changes-for-vector-valued-elements">
   Salient Changes for Vector-Valued Elements
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fesystem">
     FESystem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fevaluesextractors">
     FEValuesExtractors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#channel-with-cylinder">
     Channel with Cylinder
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dirichlet-boundary-conditions">
       Dirichlet Boundary Conditions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-from-elasticity-to-stokes">
     Exercise 1: From Elasticity to Stokes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2-explore-the-inf-sup-condition-of-the-problem">
     Exercise 2: Explore the
     <em>
      inf-sup
     </em>
     condition of the problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3-compute-forces-on-the-cylinder">
     Exercise 3: Compute forces on the cylinder
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-change-domain">
     Exercise 4: Change domain
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lab: Saddle point problems: Stokes Flow around a cylinder</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction-to-stokes-flow">
     Introduction to Stokes Flow
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#governing-equations">
       Governing Equations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weak-form-of-stokes-equations">
     Weak Form of Stokes Equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#weak-form">
       Weak Form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coupled-weak-form">
       Coupled Weak Form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boundary-conditions">
       Boundary Conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#salient-characteristics-of-stokes-flow">
       Salient Characteristics of Stokes Flow
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-stokes-flow-around-a-cylinder">
       Example: Stokes Flow Around a Cylinder
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#salient-changes-for-vector-valued-elements">
   Salient Changes for Vector-Valued Elements
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fesystem">
     FESystem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fevaluesextractors">
     FEValuesExtractors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#channel-with-cylinder">
     Channel with Cylinder
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dirichlet-boundary-conditions">
       Dirichlet Boundary Conditions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-from-elasticity-to-stokes">
     Exercise 1: From Elasticity to Stokes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2-explore-the-inf-sup-condition-of-the-problem">
     Exercise 2: Explore the
     <em>
      inf-sup
     </em>
     condition of the problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3-compute-forces-on-the-cylinder">
     Exercise 3: Compute forces on the cylinder
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-change-domain">
     Exercise 4: Change domain
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lab-saddle-point-problems-stokes-flow-around-a-cylinder">
<h1>Lab: Saddle point problems: Stokes Flow around a cylinder<a class="headerlink" href="#lab-saddle-point-problems-stokes-flow-around-a-cylinder" title="Link a questa intestazione">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link a questa intestazione">#</a></h2>
<p>In this lab, you will work with vector-valued finite element spaces to solve the Stokes Flow using the deal.II library. You will learn about reordering components in degrees of freedom based on <code class="docutils literal notranslate"><span class="pre">FESystem</span></code> to obtain block systems based on logical grouping of finite element components. You will also experiment with different finite element combinations, including <em>inf-sup</em> stable ones and not <em>inf-sup</em> stable ones.</p>
<section id="introduction-to-stokes-flow">
<h3>Introduction to Stokes Flow<a class="headerlink" href="#introduction-to-stokes-flow" title="Link a questa intestazione">#</a></h3>
<p>Stokes flow, also known as creeping flow, refers to fluid flow regimes at very low Reynolds numbers, where inertial forces are negligible compared to viscous forces. This type of flow is characterized by its simplicity and is often encountered in applications involving very slow motion of fluids or small-scale systems, such as microfluidics, lubrication theory, and the motion of biological organisms in fluids.</p>
<section id="governing-equations">
<h4>Governing Equations<a class="headerlink" href="#governing-equations" title="Link a questa intestazione">#</a></h4>
<p>The Stokes flow is governed by the following set of partial differential equations, which are a simplification of the Navier-Stokes equations:</p>
<ol class="simple">
<li><p><strong>Momentum Equation (Stokes Equation):</strong>
$<span class="math notranslate nohighlight">\(
-\eta \Delta \mathbf{u} +\nabla p = \mathbf{f}
\)</span>$
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is the velocity vector of the fluid.</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the pressure field.</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta\)</span> is the viscosity of the fluid.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is the external body force per unit volume (e.g., gravity).</p></li>
</ul>
</li>
<li><p><strong>Continuity Equation (Incompressibility Condition):</strong>
$<span class="math notranslate nohighlight">\(
\nabla \cdot \mathbf{u} = 0
\)</span>$</p></li>
</ol>
<p>These equations describe the balance of forces in a viscous fluid where the flow velocity is low enough that inertial effects can be ignored.</p>
</section>
</section>
<section id="weak-form-of-stokes-equations">
<h3>Weak Form of Stokes Equations<a class="headerlink" href="#weak-form-of-stokes-equations" title="Link a questa intestazione">#</a></h3>
<p>The weak form of the Stokes equations is derived by multiplying the momentum and continuity equations by test functions, integrating over the domain, and applying the divergence theorem. This process results in the following weak formulation:</p>
<section id="weak-form">
<h4>Weak Form<a class="headerlink" href="#weak-form" title="Link a questa intestazione">#</a></h4>
<p>To derive the weak form, we introduce test functions <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> for the velocity and <span class="math notranslate nohighlight">\(q\)</span> for the pressure, and multiply the momentum and continuity equations by these test functions. Integrating over the domain <span class="math notranslate nohighlight">\(\Omega\)</span> and applying the divergence theorem, we get:</p>
<ol class="simple">
<li><p><strong>Momentum Equation (Weak Form):</strong>
$<span class="math notranslate nohighlight">\(
\int_\Omega \eta (\nabla \mathbf{u} : \nabla \mathbf{v}) \, d\Omega + \int_\Omega p (\nabla \cdot \mathbf{v}) \, d\Omega = \int_\Omega \mathbf{f} \cdot \mathbf{v} \, d\Omega + \int_{\Gamma_N} \mathbf{h} \cdot \mathbf{v} \, d\Gamma
\)</span>$
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is the velocity vector.</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the pressure.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is the test function for velocity.</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta\)</span> is the dynamic viscosity.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is the body force per unit volume.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{h}\)</span> is the prescribed traction (Neumann boundary condition) on <span class="math notranslate nohighlight">\(\Gamma_N\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Continuity Equation (Weak Form):</strong>
$<span class="math notranslate nohighlight">\(
\int_\Omega (\nabla \cdot \mathbf{u}) q \, d\Omega = 0
\)</span>$
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the test function for pressure.</p></li>
</ul>
</li>
</ol>
<p>Combining these two equations, we obtain the coupled system in weak form:</p>
</section>
<section id="coupled-weak-form">
<h4>Coupled Weak Form<a class="headerlink" href="#coupled-weak-form" title="Link a questa intestazione">#</a></h4>
<p>Find <span class="math notranslate nohighlight">\((\mathbf{u}, p) \in \mathbf{V} \times Q\)</span> such that for all <span class="math notranslate nohighlight">\((\mathbf{v}, q) \in \mathbf{V} \times Q\)</span>:</p>
<ol class="simple">
<li><p><strong>Momentum Equation:</strong>
$<span class="math notranslate nohighlight">\(
\int_\Omega \eta (\nabla \mathbf{u} : \nabla \mathbf{v}) \, d\Omega - \int_\Omega p (\nabla \cdot \mathbf{v}) \, d\Omega = \int_\Omega \mathbf{f} \cdot \mathbf{v} \, d\Omega + \int_{\Gamma_N} \mathbf{h} \cdot \mathbf{v} \, d\Gamma
\)</span>$</p></li>
<li><p><strong>Continuity Equation:</strong>
$<span class="math notranslate nohighlight">\(
\int_\Omega (\nabla \cdot \mathbf{u}) q \, d\Omega = 0
\)</span>$</p></li>
</ol>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> is the vector-valued function space for the velocity field, and <span class="math notranslate nohighlight">\(Q\)</span> is the scalar-valued function space for the pressure field.</p>
</section>
<section id="boundary-conditions">
<h4>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link a questa intestazione">#</a></h4>
<p>The weak form must be supplemented with appropriate boundary conditions:</p>
<ul class="simple">
<li><p><strong>Dirichlet Boundary Conditions (No-slip):</strong> <span class="math notranslate nohighlight">\(\mathbf{u} = \mathbf{u}_D\)</span> on <span class="math notranslate nohighlight">\(\Gamma_D\)</span></p></li>
<li><p><strong>Neumann Boundary Conditions (Traction):</strong> <span class="math notranslate nohighlight">\(\mathbf{\sigma} \cdot \mathbf{n} = \mathbf{h}\)</span> on <span class="math notranslate nohighlight">\(\Gamma_N\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\sigma}\)</span> is the stress tensor, and <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is the outward normal vector on the boundary.</p>
<p>This weak formulation serves as the basis for the finite element method to solve the Stokes flow problem numerically.</p>
</section>
<section id="salient-characteristics-of-stokes-flow">
<h4>Salient Characteristics of Stokes Flow<a class="headerlink" href="#salient-characteristics-of-stokes-flow" title="Link a questa intestazione">#</a></h4>
<ol class="simple">
<li><p><strong>Linearity:</strong></p>
<ul class="simple">
<li><p>The Stokes equations are linear in terms of the velocity and pressure fields, which simplifies their analytical and numerical treatment.</p></li>
</ul>
</li>
<li><p><strong>Reversibility:</strong></p>
<ul class="simple">
<li><p>The flow is time-reversible, meaning if the flow is reversed, it retraces its path exactly. This property is a direct consequence of the linearity and lack of inertial terms.</p></li>
</ul>
</li>
<li><p><strong>Dominance of Viscous Forces:</strong></p>
<ul class="simple">
<li><p>Viscous forces dominate over inertial forces, making the flow highly smooth and laminar. The Reynolds number (<span class="math notranslate nohighlight">\(Re\)</span>) for Stokes flow is much less than 1.</p></li>
</ul>
</li>
<li><p><strong>Boundary Layer:</strong></p>
<ul class="simple">
<li><p>There is no boundary layer separation as seen in high Reynolds number flows. The fluid adheres closely to the boundaries and obstacles.</p></li>
</ul>
</li>
<li><p><strong>Applications:</strong></p>
<ul class="simple">
<li><p>Stokes flow is applicable in various fields, including microfluidics, biological fluid dynamics (e.g., the motion of microorganisms), and porous media flow.</p></li>
</ul>
</li>
</ol>
</section>
<section id="example-stokes-flow-around-a-cylinder">
<h4>Example: Stokes Flow Around a Cylinder<a class="headerlink" href="#example-stokes-flow-around-a-cylinder" title="Link a questa intestazione">#</a></h4>
<p>In this lab, we will focus on the classical problem of Stokes flow around a cylindrical obstacle within a channel. This setup is useful for studying how the presence of an obstacle affects the flow pattern in a viscous fluid. The cylindrical obstacle introduces complexity in the flow field, leading to the development of a symmetric flow pattern around the cylinder.</p>
<p>The boundary conditions for this problem typically include:</p>
<ul class="simple">
<li><p><strong>No-Slip Boundary Condition:</strong> The fluid velocity at the solid boundary (cylinder surface and channel walls) is zero.</p></li>
<li><p><strong>Inflow/Outflow Boundary Conditions:</strong> Specified velocity profile at the inlet and zero normal stress at the outlet.</p></li>
</ul>
<p>By solving the Stokes equations for this problem, we can obtain insights into the velocity and pressure distributions in the fluid, as well as the forces exerted on the cylinder by the fluid. This understanding is critical for designing and analyzing systems where low Reynolds number flows are prevalent.</p>
</section>
</section>
</section>
<section id="salient-changes-for-vector-valued-elements">
<h2>Salient Changes for Vector-Valued Elements<a class="headerlink" href="#salient-changes-for-vector-valued-elements" title="Link a questa intestazione">#</a></h2>
<section id="fesystem">
<h3>FESystem<a class="headerlink" href="#fesystem" title="Link a questa intestazione">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">FESystem</span></code> is used to create a vector-valued finite element space by combining scalar finite elements. In this lab, <code class="docutils literal notranslate"><span class="pre">FESystem&lt;dim&gt;</span></code> is created using a combination of <code class="docutils literal notranslate"><span class="pre">FE_Q&lt;dim&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">FE_DGQ&lt;dim&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">FE_DGP&lt;dim&gt;</span></code> elements.</p>
<p>For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FESystem</span><span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fe</span><span class="p">(</span><span class="n">FE_Q</span><span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="p">(</span><span class="n">par</span><span class="p">.</span><span class="n">fe_degree</span><span class="p">),</span><span class="w"> </span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">FE_Q</span><span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="p">(</span><span class="n">par</span><span class="p">.</span><span class="n">fe_degree</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This creates a vector-valued finite element space for velocity (dim components) and pressure (1 component).</p>
</section>
<section id="fevaluesextractors">
<h3>FEValuesExtractors<a class="headerlink" href="#fevaluesextractors" title="Link a questa intestazione">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">FEValuesExtractors</span></code> are used to access specific components of the vector field in <code class="docutils literal notranslate"><span class="pre">FEValues</span></code> and <code class="docutils literal notranslate"><span class="pre">FEFaceValues</span></code> objects. For example, to extract velocity and pressure components:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FEValuesExtractors</span><span class="o">::</span><span class="n">Vector</span><span class="w"> </span><span class="nf">velocities</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="n">FEValuesExtractors</span><span class="o">::</span><span class="n">Scalar</span><span class="w"> </span><span class="nf">pressure</span><span class="p">(</span><span class="n">dim</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>These extractors can then be used to access the values, gradients, and other quantities of the respective fields.</p>
</section>
<section id="channel-with-cylinder">
<h3>Channel with Cylinder<a class="headerlink" href="#channel-with-cylinder" title="Link a questa intestazione">#</a></h3>
<p>We will create a domain that consists of a channel with a cylinder at the beginning using the <code class="docutils literal notranslate"><span class="pre">GridGenerator::channel_with_cylinder</span></code> function from the deal.II library. This setup is commonly used to study flow around obstacles.</p>
<p>Add all respective parameters to the parameter file.</p>
<section id="dirichlet-boundary-conditions">
<h4>Dirichlet Boundary Conditions<a class="headerlink" href="#dirichlet-boundary-conditions" title="Link a questa intestazione">#</a></h4>
<p>Dirichlet boundary conditions are imposed using <code class="docutils literal notranslate"><span class="pre">AffineConstraints&lt;double&gt;</span></code>, with the addition of one more argument to <code class="docutils literal notranslate"><span class="pre">interpolate_boundary_values</span></code>, corresponding to the finite element component mask to which we want to impose Dirichlet conditions (in this case, only the velocity):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">VectorTools</span><span class="o">::</span><span class="n">interpolate_boundary_values</span><span class="p">(</span><span class="n">dof_handler</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">par</span><span class="p">.</span><span class="n">exact_solution</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">constraints</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">fe</span><span class="p">.</span><span class="n">component_mask</span><span class="w"> </span><span class="p">(</span><span class="n">velocity</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Impose zero Dirichlet boundary conditions on the top, bottom, and cylinder walls</p></li>
<li><p>Impose inflow Dirichlet boundary conditions in the inflow boundary (inflow function from parameter file)</p></li>
<li><p>Impose zero Neumann boundary conditions on the outflow</p></li>
</ul>
</section>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link a questa intestazione">#</a></h2>
<section id="exercise-1-from-elasticity-to-stokes">
<h3>Exercise 1: From Elasticity to Stokes<a class="headerlink" href="#exercise-1-from-elasticity-to-stokes" title="Link a questa intestazione">#</a></h3>
<p>Change the assembly and everything else you need to assemble Stokes instead of linear Elasticity.</p>
</section>
<section id="exercise-2-explore-the-inf-sup-condition-of-the-problem">
<h3>Exercise 2: Explore the <em>inf-sup</em> condition of the problem<a class="headerlink" href="#exercise-2-explore-the-inf-sup-condition-of-the-problem" title="Link a questa intestazione">#</a></h3>
<ol class="simple">
<li><p>Test the behaviour of the code for the following pairs of finite element spaces:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FE_Q(1)^d-FE_Q(1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FE_Q(1)^d-FE_DGQ(0)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FE_Q(2)^d-FE_Q(1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FE_Q(2)^d-FE_DGP(1)</span></code></p></li>
</ul>
<p>Make sure you can change the finite element spaces from the parameter file, using <code class="docutils literal notranslate"><span class="pre">FETools::get_fe_by_name()</span></code></p>
</section>
<section id="exercise-3-compute-forces-on-the-cylinder">
<h3>Exercise 3: Compute forces on the cylinder<a class="headerlink" href="#exercise-3-compute-forces-on-the-cylinder" title="Link a questa intestazione">#</a></h3>
<p>Integrate on the surface of the cylinder the term <span class="math notranslate nohighlight">\(\sigma \cdot n\)</span> where <span class="math notranslate nohighlight">\(\sigma := \eta \nabla u\cdot n - p n\)</span>. This represents the forces experienced by the cylinder. If the cylinder is not in the center, the lift (vertical component of the force) should be non zero. Make sure your code behaves correctly from the physical point of view.</p>
</section>
<section id="exercise-4-change-domain">
<h3>Exercise 4: Change domain<a class="headerlink" href="#exercise-4-change-domain" title="Link a questa intestazione">#</a></h3>
<p>Use the classes in <code class="docutils literal notranslate"><span class="pre">GridGenerator::Airfoil</span></code> to change the domain to a channel with a Naca Airfoil, and experiment with the possibilities given by that class. Compare the lift forces with the spherical case.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="lab-08.html" title="precedente pagina">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">precedente</p>
            <p class="prev-next-title">Lab: From CG Poisson to DG Poisson (SIPG)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="projects.html" title="successivo pagina">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">successivo</p>
        <p class="prev-next-title">Final projects</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Luca Heltai<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>